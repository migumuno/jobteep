<html>
<head>
<title>CV Academico</title>
<script type="text/javascript" src="https://platform.linkedin.com/in.js">
  api_key: 77i0wrm327h22q
  authorize: true
  scope: r_fullprofile
</script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<script src="js/jquery.js" type="text/javascript"></script>
    <link type="text/css" rel="stylesheet" href="css/custom-theme/jquery-ui.css" /> 
    <script src="js/jquery-ui.js"></script>
	<style>
		.wrapp{width:964px;*width:920px;margin:0 auto;overflow:hidden;background: url('images/flechas.png') no-repeat center 250px #fff;font-family: Arial,Helvetica,sans-serif;font-size:11px;}
		.cabeceras h2{font-family: Arial,Helvetica,sans-serif;font-size:20px;color: #197BB9;margin:10px 0 0;padding:0;width: 50%;float:left;text-align:center;position:relative;}
		.ui-widget {font-family: Arial,Helvetica,sans-serif;font-size: 11px; line-height:1.5}
		.empresa{border:solid 1px black; padding:5px; margin:5px;}
		.column { width: 380px; float: left; padding:10px;border:1px dashed #ddd;background-color:#fafafa;margin:10px 40px;border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px;
		min-height: 500px;height:auto !important;height:500px;
-moz-box-shadow: 0 0 5px #ccc inset;-webkit-box-shadow: 0 0 5px #ccc inset; box-shadow: 0 0 5px #ccc inset; }
		.portlet { margin: 0 0 1em;border:1px solid #efefef; cursor: move;box-shadow: 0 2px 5px #ccc;-webkit-box-shadow: 0 2px 5px #ccc;-moz-box-shadow: 0 2px 5px #ccc;}
		.portlet-header .ui-icon { float: right; }
		 .portlet-header { background: #197bb9;color:#fff; font-weight:700;margin:0; padding:5px 10px;border-radius:4px 4px 0 0;-moz-border-radius:4px 4px 0 0;-webkit-border-radius:4px 4px 0 0;}
		.portlet-content { padding: 10px; }
		.ui-sortable-placeholder { border: 1px dotted black; visibility: visible !important; height: 50px !important; }
		.ui-sortable-placeholder * { visibility: hidden; }
		.saveBtn{position:absolute;background:#197BB9;padding:5px 10px;color:#fff;text-decoration:none;margin:0;font-weight:700;border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px;font-size: 11px;right:40px;border:2px solid #197BB9;}
		.saveBtn:hover{color:#197BB9;background:#fff;border:2px solid #197BB9;}
		#txt_linkedin{font-family: Arial,Helvetica,sans-serif;font-size:16px;color: #197BB9;padding:10px;background:#fafafa;text-align:center;}
	</style>

	<script type="text/javascript">
		function loadData() {	
			meses=new Array('Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre');
		
		  	IN.API.Profile("me").fields(["educations"]).result(function(resultado) {  
		  		$('#txt_linkedin').remove();      
				
		      	if(resultado.values[0].educations != null){
			      	estudios = resultado.values[0].educations.values;
			      			      	
			      	document.CurriculumForm.listaLinkedin.value = JSON.stringify(estudios);
			      	
			      	for(i=0;i<estudios.length; i++){			    	   
				    	capa = $('#plantilla').html();   
				    	capa = capa.replace('{id}', estudios[i].id);    
				    	capa = capa.replace('{titulo}', estudios[i].degree);
				    	capa = capa.replace('{centro}', estudios[i].schoolName); 
				    	capa = capa.replace('{campo}', estudios[i].fieldOfStudy);
				    	capa = capa.replace('{actividades}', (estudios[i].activities)?'Actividades: <strong>'+estudios[i].activities+'</strong><br />':'');    			    	    			    	
				    	capa = capa.replace('{comentarios}', (estudios[i].notes)?estudios[i].notes:'');    	    	
				    				    	
				    	 
				    	capa = capa.replace('{fh_desde}', (estudios[i].startDate)? estudios[i].startDate.year: '' );
				    	    
				    	fecha = (estudios[i].endDate)? estudios[i].endDate.year:' la actualidad';    
			    	    capa = capa.replace('{fh_hasta}', fecha );
			    	    
						$('#listadoLinkedin').append(capa);			          
			     	}
				   
			    	    
	
					$( ".column" ).sortable({
						connectWith: ".column",
						cancel: ".bloqueado"
					});		
					$( ".portlet" ).addClass( "ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" )
						.find( ".portlet-header" )
						.addClass( "ui-widget-header ui-corner-all" )							
						.end()
						.find( ".portlet-content" );							
					$( ".column" ).disableSelection();
		      	}else{
		      		$('#plantilla .portlet-header').html('');	      	
		      		$('#plantilla .portlet-content').html('No tiene historial academico en Linkedin');	
		      		capa = $('#plantilla').html();   

					$('#listadoLinkedin').append(capa);		
		      	}	
		    });    
		}
		
		function guardarLinkedin(){
			$('#listadoCurriculum div').each(function(){
				if($(this).attr('id')){
					document.CurriculumForm.listaIds.value +=	',' + $(this).attr('id');			
				}
			});
			document.CurriculumForm.submit();				
		}
		
		
	</script>


</head>
<body>
<div id="profile"></div>
<script type="IN/Login" data-onAuth="loadData"></script> <span id="txt_linkedin">--- Identificate en Linkedin para acceder a tu Curriculum profesional</span>

<div id="plantilla" style="display:none;">
	<div class="portlet" id="{id}">
		<div class="portlet-header">Titulo: {titulo}</div>
		<div class="portlet-content">
			Centro: <strong>{centro}</strong><br />
			Campo de estudio: <strong>{campo}</strong><br />
			Desde {fh_desde} hasta {fh_hasta}<br />
			{actividades}
			{comentarios}
		</div>
	</div>
</div>

<div class="wrapp">
<div class="cabeceras">
    <h2>En Linkedin</h2>
    <h2>En tu perfil <a href="javascript:guardarLinkedin();void(0);" class="saveBtn">Guardar</a></h2>
</div><!-- cabeceras -->

<div id="listadoLinkedin" class="column">

</div>
<cfset meses= 'Enero,Febrero,Marzo,Abril,Mayo,Junio,Julio,Agosto,Septiembre,Octubre,Noviembre,Diciembre'>

<div id="listadoCurriculum" class="column">
	<cfoutput query="QRY_l_Curriculum">
	<div class="portlet bloqueado">
		<div class="portlet-header">Titulo: #titulo#</div>
		<div class="portlet-content">
			Centro: <strong>#centro#</strong><br />
			<cfif len(campo_estudio)>Campo de estudio: <strong>#campo_estudio#</strong><br /></cfif>
			Desde <cfif isnumeric(mes_desde) and mes_desde gt 0>#listgetat(meses, mes_desde)# de </cfif>#anno_desde# 
			hasta <cfif actualmente eq 1>la actualidad<cfelse>
				  	<cfif isnumeric(mes_hasta) and mes_hasta gt 0>#listgetat(meses, mes_hasta)# de </cfif>#anno_hasta#
				  </cfif><br />
			<cfif len(actividades)>Actividades: <strong>#actividades#</strong><br /></cfif>	  
			#comentarios#	  
		</div>
	</div>
	</cfoutput>
</div>

</div><!-- wrapp -->

<div style="display:none;">
<form name="CurriculumForm" method="post">
	<textarea name="listaLinkedin"></textarea>
	<input type="text" name="listaIds" value="" />	
</form>
</div>

</body>
</html>